@host = http://localhost:3000
@apiPrefix = api
@baseUrl = {{host}}/{{apiPrefix}}
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1ODkzNTIwZC01YWY0LTRhZDgtYmRjMS05MmE2M2YzZjgzMmIiLCJyb2xlIjoidXNlciIsImlhdCI6MTc2ODY0OTg1OSwiZXhwIjoxNzY4NzM2MjU5fQ.NW_2ewu0wvwjerz3XJOabOPrbGAI_YPYKl7w-9U2XAE
@uploadUrl = https://storage.googleapis.com/job-seeking-bucket/documents/5893520d-5af4-4ad8-bdc1-92a63f3f832b/ba60a200-9687-4cc4-9f74-ec9197bba40b/sample.pdf?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=job-seeking-service-account%40job-seeking-service.iam.gserviceaccount.com%2F20260108%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20260108T195740Z&X-Goog-Expires=900&X-Goog-SignedHeaders=content-type%3Bhost&X-Goog-Signature=42cc8da3dac845efab76de59580b95d4d7257f702bc9536c7704e414c0832f3e08e8af8dc3b61f72cf0f3bf2abcbe2cc61cb8e3ceba3b38f6f7d1b04543bcb04ac6adab0496cf0a53d41049143d808abec754ad491f511abc90cabd48858aceccf43c53cbc91d1f3ee77ec687b99de94173b68dd72971a8e74d08624fccfc7a4de1de7a64daa711c6ca8c17680aa0e57c164fea91ae80ec8ea0a59257a6b2fcdb91ec9c11050fdb420da4f49a6c82c9352e8183f839dcbeff03c7c626bdbc4e6943ce4c8bd81e8f4704c7d6f3fccfbcd7128a5269ba1f4ef4dfd86c17ef62a5c0ec72f0e323107f5df5d1d357b65d17644737e2a2e6da8f8922b6c124e807c03
### Health check (public)
GET http://localhost:3000/health

### Health test (public)
GET http://localhost:3000/health/test

### Send register code (public)
POST {{baseUrl}}/auth/send-register-code
Content-Type: application/json

{
  "email": "copaca7463@gopicta.com"
}

### Register (public)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "copaca7463@gopicta.com",
  "password": "Password123!",
  "confirmPassword": "Password123!",
  "code": "987149"
}

### Login (public)
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "copaca7463@gopicta.com",
  "password": "Password123!?"
}

### Logout (auth)
POST {{baseUrl}}/auth/logout
Authorization: Bearer {{accessToken}}

### Change password (auth)
POST {{baseUrl}}/auth/change-password
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "oldPassword": "Password123!",
  "password": "Password123!?",
  "confirmPassword": "Password123!?"
}

### Reset password (public)
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "email": "user@example.com",
  "code": "123456",
  "newPassword": "Password123!",
  "confirmPassword": "Password123!"
}

### Send reset password code (public)
POST {{baseUrl}}/auth/send-reset-password-code
Content-Type: application/json

{
  "email": "user@example.com"
}

### Get current user (auth)
GET {{baseUrl}}/user
Authorization: Bearer {{accessToken}}

### Create profile input (auth)
POST {{baseUrl}}/profile-inputs
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "targetRoles": "JavaScript developer, TypeScript developer, Next.js developer",
  "notes": "Looking for mid-level roles, remote preferred."
}

### Get latest profile input (auth)
GET {{baseUrl}}/profile-inputs/latest
Authorization: Bearer {{accessToken}}

### Create document upload URL (auth)
POST {{baseUrl}}/documents/upload-url
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "type": "CV",
  "originalName": "sample.pdf",
  "mimeType": "application/pdf",
  "size": 123456
}

### Upload PDF to signed URL (public)
PUT {{uploadUrl}}
Content-Type: application/pdf

< ./apps/api/test-files/real_pdf.pdf

### Confirm document upload (auth)
POST {{baseUrl}}/documents/confirm
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "documentId": "ba60a200-9687-4cc4-9f74-ec9197bba40b"
}

### List documents (auth)
GET {{baseUrl}}/documents
Authorization: Bearer {{accessToken}}

### List documents by type (auth)
GET {{baseUrl}}/documents?type=CV
Authorization: Bearer {{accessToken}}

### Extract document text (auth)
POST {{baseUrl}}/documents/extract
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "documentId": "ba60a200-9687-4cc4-9f74-ec9197bba40b"
}

### Sync documents with storage (auth)
POST {{baseUrl}}/documents/sync
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "dryRun": false,
  "deleteMissing": false,
  "missingGraceMinutes": 30,
  "previewLimit": 50
}

### Get document by id (auth)
GET {{baseUrl}}/documents/replace_with_document_id
Authorization: Bearer {{accessToken}}

### Update document metadata (auth)
PATCH {{baseUrl}}/documents/replace_with_document_id
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "type": "CV",
  "originalName": "updated-name.pdf"
}

### Delete document (auth)
DELETE {{baseUrl}}/documents/replace_with_document_id
Authorization: Bearer {{accessToken}}

### Create career profile (auth)
POST {{baseUrl}}/career-profiles
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "instructions": "Focus on backend roles and highlight NestJS experience."
}

### Get latest career profile (auth)
GET {{baseUrl}}/career-profiles/latest
Authorization: Bearer {{accessToken}}

### List career profile versions (auth)
GET {{baseUrl}}/career-profiles?status=READY&isActive=true&limit=10&offset=0
Authorization: Bearer {{accessToken}}

### Get career profile by id (auth)
GET {{baseUrl}}/career-profiles/a75cc0b4-8dfc-4ed7-9010-8d20aaac9ab4
Authorization: Bearer {{accessToken}}

### Restore career profile version (auth)
POST {{baseUrl}}/career-profiles/a75cc0b4-8dfc-4ed7-9010-8d20aaac9ab4/restore
Authorization: Bearer {{accessToken}}

### List documents for career profile (auth)
GET {{baseUrl}}/career-profiles/a75cc0b4-8dfc-4ed7-9010-8d20aaac9ab4/documents
Authorization: Bearer {{accessToken}}

### Score job fit (auth)
POST {{baseUrl}}/job-matching/score
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "jobDescription": "We are looking for a backend developer with NestJS, PostgreSQL, and REST API experience.",
  "minScore": 60
}
